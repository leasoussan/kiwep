{% load i18n %}
{% load static %}
{% load materializecss %}

{% block css %}
    <link href="{% static 'backend/css/answer.css' %}" rel="stylesheet" >

{% endblock css %}





{% if user.is_student %}

    {% if user.profile == object.attributed_to %}

        <ul class="collapsible popout answer_list_box">

            {% if object.answer.all.exists %}

                {% with answers=object.answer.all.last %}

                    <li>
                        <div class="collapsible-header"><i class="material-icons">filter_drama</i><label>{% trans 'your_last_answer' %}</label></div>
                          {% trans 'status' %}: {{ object.answer.get_status_display }}

                        {% if answer.grade %}
                            {% trans 'and_graded :' %}
                            {{ answer.grade }}

                            {% if answer.status %}
                                <p> {% trans 'answer_status' %}: {{ answer.status }} </p>
                            {% elif answer.status == 'a' %}
                                {% if not answer.grade %}

                                    <p>{% trans 'mission_not_graded' %}</p>
                                {% else %}
                                    {% trans 'grade_for_mission ' %}: {{ answer.grade }}
                                {% endif %}

                            {% else %}

                                <p> {% trans 'mission_wasnt_accepted_yet' %}</p>
                            {% endif %}


                        {% endif %}
{% endwith %}
                    </li>
  {% with answers=object.answer.all %}
                    {% for answer in answers %}
                        <li class="#">
                        <div class="collapsible-header answer_line">
                        <i class="material-icons">filter_drama</i>
                        <label>{% trans 'your_past_answer' %}</label>
                        {% trans 'status' %}: {{ object.answer.get_status_display }}

                        {% if answer.grade %}
                            {% trans 'and_graded :' %}
                            {{ answer.grade }}

                            {% if answer.status %}
                                <p> {% trans 'answer_status' %}: {{ answer.status }} </p>
                            {% elif answer.status == 'a' %}
                                {% if not answer.grade %}

                                    <p>{% trans 'mission_not_graded' %}</p>
                                {% else %}
                                    {% trans 'grade_for_mission ' %}: {{ answer.grade }}
                                {% endif %}

                            {% else %}

                                <p> {% trans 'mission_wasnt_accepted_yet' %}</p>
                            {% endif %}


                        {% endif %}

                    {% endfor %}
                {% endwith %}

            </div>

            <div class="collapsible-body"><span>{{answer.response_comment}}</span>
                {##}
                HEre we are

                {#                                    {% if user.is_speaker %}#}
                {#                                        <form method="POST" action = "{% url 'answer_edit_status' answer.id %}?next={{ request.path }} " enctype="multipart/form-data" >#}
                {#                                            {% csrf_token %}#}
                {##}
                {#                                            {{ answer.status_form|materializecss }}#}
                {##}
                {#                                            <button class="btn waves-effect waves-light secondary_button" type="submit" name="action">{% trans 'save_answer' %}#}
                {#                                            </button>#}
                {#                                        </form>#}
                {#                                    {% endif %}#}

            </div>

            </li>


                </ul>

                {##}
                {#                            {% with answer=object.answer.last %}#}
                {##}
                {#                                <div class="answer_content" style="background-color: yellow">#}
                {#                                    <h3>{% trans 'add_new_answer' %}</h3>#}
                {#                                    <form method="POST" action="{% url 'answer_edit_status' answer.id %}">#}
                {#                                        {% csrf_token %}#}
                {##}
                {##}
                {#                                        {{ answer.status_form }}#}
                {#                                        <button type="submit">{% trans 'send_answer' %}</button>#}
                {#                                    </form>#}
                {##}
                {#                                    </form>#}
                {##}
                {##}
                {#                                </div>#}
                {#                                </div>#}
                {#                            {% endwith %}#}
            {% endif %}


    {% endif %}
{% endif %}





{#                    <div class="answer_content" style="background-color: yellow">#}
{#                        <h3>{% trans 'add_new_answer' %}</h3>#}
{#                        <form method="POST" action="{% url 'answer_edit_status' answer.id %}">#}
{#                            {% csrf_token %}#}
{##}
{##}
{#                            {{ answer.status_form }}#}
{#                            <button type="submit">{% trans 'send_answer' %}</button>#}
{#                        </form>#}
{#                    </div>#}
{#                        </form>#}

{##}
{##}
{#<div class="add_answer">#}
{##}
{#    <span class="answer_label">{% trans 'add_answer'%} to  {{object}} </span>#}
{#    <form method="POST" action = "{% url 'answer_add' %}?next={{ request.path }} " enctype="multipart/form-data" >#}
{#        {% csrf_token %}#}
{##}
{##}
{#        {{ object.answer_form|materializecss }}#}
{##}
{##}
{#        <button class="btn waves-effect waves-light secondary_button" type="submit" name="action">{% trans 'save_answer' %}#}
{#        </button>#}
{#    </form>#}
{##}
{#</div>#}
{##}
{##}
